(function(){"use strict";var t={238:function(t,e,i){var s=i(5130),n=i(6768),a=i(4232);const o={id:"main"},u={id:"controls"},r={id:"file-chooser-container"},h={id:"file-chooser-label",class:"button"},d=(0,n.Lk)("br",null,null,-1),l={key:0,class:"control-section"},g={id:"slider-container"},c={key:1,class:"control-section"},p=(0,n.Lk)("div",null,"Edge detection algorithm",-1),v={key:0,id:"canny-params"},C=(0,n.Lk)("div",{id:"hysteresis-threshold-range-container"},[(0,n.eW)(" Hysteresis thresholds "),(0,n.Lk)("br"),(0,n.Lk)("div",{id:"hysteresis-threshold-range"})],-1),m=(0,n.Lk)("br",null,null,-1),y={key:2,class:"control-section"},f={key:1},w=(0,n.Lk)("br",null,null,-1),k=["value"],b=(0,n.Lk)("div",null,[(0,n.Lk)("label",null,[(0,n.Lk)("input",{id:"fuzzy-contours-checkbox",type:"checkbox"}),(0,n.eW)(" Fuzzy contours? ")])],-1),x={key:3,id:"spinner"},I=(0,n.Lk)("img",{src:"spinner.gif"},null,-1),P=[I],L=(0,n.Fv)('<div id="output"><canvas id="preview-canvas" width="300" height="600"></canvas></div><canvas id="input-canvas" width="300" height="600"></canvas><canvas id="output-canvas"></canvas><img id="input-image" class="hidden"><img id="edge-image" class="hidden">',5);function E(t,e,i,s,I,E){return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.Lk)("div",u,[(0,n.Lk)("div",r,[(0,n.Lk)("label",h,[(0,n.eW)("Choose Image File "),(0,n.Lk)("input",{type:"file",id:"image-file-chooser",onChange:e[0]||(e[0]=(...t)=>E.setImageFile&&E.setImageFile(...t))},null,32)]),d]),I.isImageLoaded?((0,n.uX)(),(0,n.CE)("div",l,[(0,n.Lk)("div",null,[(0,n.Lk)("label",null,[(0,n.Lk)("input",{type:"radio",name:"contrast-type",value:"hue",id:"contrast-type-hue",onChange:e[1]||(e[1]=(...t)=>E.updateContrast&&E.updateContrast(...t))},null,32),(0,n.eW)(" Hue ")]),(0,n.Lk)("label",null,[(0,n.Lk)("input",{type:"radio",name:"contrast-type",value:"sat",id:"contrast-type-sat",onChange:e[2]||(e[2]=(...t)=>E.updateContrast&&E.updateContrast(...t))},null,32),(0,n.eW)(" Saturation ")]),(0,n.Lk)("label",null,[(0,n.Lk)("input",{type:"radio",name:"contrast-type",value:"val",id:"contrast-type-val",checked:"",onChange:e[3]||(e[3]=(...t)=>E.updateContrast&&E.updateContrast(...t))},null,32),(0,n.eW)(" Value ")])]),(0,n.Lk)("div",g,[(0,n.Lk)("label",null,[(0,n.eW)(" Cutoff "),(0,n.Lk)("input",{type:"range",min:"1",max:"100",value:"50",class:"slider",id:"contrast-range",onClick:e[4]||(e[4]=(...t)=>E.updateContrast&&E.updateContrast(...t)),onChange:e[5]||(e[5]=(...t)=>E.updateContrast&&E.updateContrast(...t))},null,32)])])])):(0,n.Q3)("",!0),I.isContrastComputed?((0,n.uX)(),(0,n.CE)("div",c,[p,(0,n.Lk)("div",null,[(0,n.Lk)("label",null,[(0,n.Lk)("input",{type:"radio",name:"edge-detection-type",value:"simple",id:"edge-detection-type-simple",onChange:e[6]||(e[6]=(...t)=>E.setEdgeDetectionType&&E.setEdgeDetectionType(...t))},null,32),(0,n.eW)(" Simple ")]),(0,n.Lk)("label",null,[(0,n.Lk)("input",{type:"radio",name:"edge-detection-type",value:"canny",id:"edge-detection-type-canny",onChange:e[7]||(e[7]=(...t)=>E.setEdgeDetectionType&&E.setEdgeDetectionType(...t))},null,32),(0,n.eW)(" Canny ")]),(0,n.Lk)("label",null,[(0,n.Lk)("input",{type:"radio",name:"edge-detection-type",value:"none",id:"edge-detection-type-none",onChange:e[8]||(e[8]=(...t)=>E.setEdgeDetectionType&&E.setEdgeDetectionType(...t))},null,32),(0,n.eW)(" None ")]),I.isShowCannyParams?((0,n.uX)(),(0,n.CE)("div",v,[C,(0,n.Lk)("div",null,[(0,n.eW)(" Gaussian blur sigma: "+(0,a.v_)(I.gaussianSigma.toFixed(2)),1),m,(0,n.Lk)("input",{type:"range",min:"0",max:"100",class:"slider",id:"gaussian-sigma-range",onInput:e[9]||(e[9]=(...t)=>E.setGaussianSigmaRange&&E.setGaussianSigmaRange(...t))},null,32)])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",{id:"detect-edges-button",class:"button",onClick:e[10]||(e[10]=(...t)=>E.detectEdges&&E.detectEdges(...t))}," Detect Edges ")])):(0,n.Q3)("",!0),I.isEdgesComputed?((0,n.uX)(),(0,n.CE)("div",y,[I.isContourDrawn?((0,n.uX)(),(0,n.CE)("div",{key:0,id:"save-image-button",class:"button",onClick:e[11]||(e[11]=(...t)=>E.saveImage&&E.saveImage(...t))}," Save Image ")):((0,n.uX)(),(0,n.CE)("div",f,[(0,n.Lk)("label",null,[(0,n.eW)(" Radius: "+(0,a.v_)(I.contourRadius),1),w,(0,n.Lk)("input",{type:"range",min:"2",max:"20",value:I.contourRadius,class:"slider",id:"contour-radius-range",onInput:e[12]||(e[12]=(...t)=>E.setContourRadiusRange&&E.setContourRadiusRange(...t))},null,40,k)])])),b,(0,n.Lk)("div",null,[(0,n.Lk)("div",{id:"draw-contours-button",class:"button",onClick:e[13]||(e[13]=(...t)=>E.drawContours&&E.drawContours(...t))}," Draw Contours ")])])):(0,n.Q3)("",!0),(0,n.Lk)("div",{id:"reset-button",class:"button",onClick:e[14]||(e[14]=(...t)=>E.reset&&E.reset(...t))},"Reset"),I.isInProgress?((0,n.uX)(),(0,n.CE)("div",x,P)):(0,n.Q3)("",!0)]),L])}i(4114);var T=i(4227),R=i(4131);const D=1.1,S="#000000",B="#ffffff",W={low:10,high:30};var A={name:"App",data(){return{isInProgress:!1,isImageLoaded:!1,isContrastComputed:!1,isShowCannyParams:!1,isEdgesComputed:!1,isContourDrawn:!1,gaussianSigma:D,contourRadius:6,edgeDetectionType:"simple",previewContext:null,outputContext:null,inputContext:null,inputCanvas:null,previewCanvas:null,edgePoints:[],img:null,edgeImg:null}},methods:{saveImage(){const t=document.createElement("a"),e=this.outputCanvas.toDataURL();t.setAttribute("href",e),t.setAttribute("download","contour-doodler-output.png"),t.click(),this.copyToPreview(),console.log("saved")},drawContours(){this.isContourDrawn=!1,this.isInProgress=!0,setTimeout((()=>{const t=this.contourRadius,e=document.getElementById("fuzzy-contours-checkbox").checked;this.outputContext.fillStyle=S;for(const i of this.edgePoints){if(e){const e=this.outputContext.createRadialGradient(i[0],i[1],0,i[0],i[1],t);e.addColorStop(0,S),e.addColorStop(1,"rgba(255, 255, 255, 0)"),this.outputContext.fillStyle=e}this.outputContext.beginPath(),this.outputContext.arc(i[0],i[1],t,0,2*Math.PI),this.outputContext.fill()}for(const i of this.edgePoints)this.setPixel(this.outputContext,i[0],i[1],B);this.isInProgress=!1,this.copyToPreview(),this.isContourDrawn=!0}),0)},reset(){this.isContrastComputed=!1,this.isEdgesComputed=!1,this.isContourDrawn=!1,this.previewContext.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),this.outputContext.clearRect(0,0,this.outputCanvas.width,this.outputCanvas.height),this.repaint()},detectEdges(){const t=this.edgeDetectionType;this.isInProgress=!0,this.isEdgesComputed=!1,this.isContourDrawn=!1,setTimeout((async()=>{if("none"==t){this.edgePoints=[];const t=this.outputContext.getImageData(0,0,this.outputCanvas.width,this.outputCanvas.height);for(let e=0;e<this.outputCanvas.width;e++)for(let i=0;i<this.outputCanvas.height;i++)this.isBlack(this.getPixel(t,e,i))&&this.edgePoints.push([e,i]);this.isEdgesComputed=!0,this.isInProgress=!1}else if("canny"==t){const t=await R.Ay.load(this.outputCanvas.toDataURL()),e=t.gray(),i={gaussianBlur:this.gaussianSigma,lowThreshold:W.low,highThreshold:W.high},s=(0,T.A)(e,i);this.edgeImg.src=s.toDataURL()}else if("simple"==t){this.edgePoints=[];const t=this.outputContext.getImageData(0,0,this.outputCanvas.width,this.outputCanvas.height);this.outputContext.fillStyle=B,this.outputContext.fillRect(0,0,this.outputCanvas.width,this.outputCanvas.height);for(let e=1;e<this.outputCanvas.width-1;e++)for(let i=1;i<this.outputCanvas.height-1;i++)this.isWhite(this.getPixel(t,e,i))&&(this.isBlack(this.getPixel(t,e-1,i))||this.isBlack(this.getPixel(t,e+1,i))||this.isBlack(this.getPixel(t,e,i-1))||this.isBlack(this.getPixel(t,e,i+1)))&&(this.edgePoints.push([e,i]),this.setPixel(this.outputContext,e,i,S));this.isEdgesComputed=!0,this.copyToPreview(),this.isInProgress=!1}}),0)},setEdgeDetectionType(){this.isEdgesComputed=!1,this.isContourDrawn=!1,this.edgeDetectionType=document.querySelector("[name='edge-detection-type']:checked").value,this.isShowCannyParams="canny"==this.edgeDetectionType,this.isShowCannyParams&&setTimeout(this.initHysteresisRange,0)},setGaussianSigmaRange(){const t=parseInt(document.getElementById("gaussian-sigma-range").value);this.gaussianSigma=Math.pow(t/50,2)},setContourRadiusRange(){const t=parseInt(document.getElementById("contour-radius-range").value);this.contourRadius=t},setImageFile(){if(this.isImageLoaded=!1,this.isContrastComputed=!1,this.isEdgesComputed=!1,this.isContourDrawn=!1,"function"!==typeof window.FileReader)return void alert("The browser you are using sucks.\nTry using Firefox or Chrome instead.");const t=document.getElementById("image-file-chooser");if(t)if(t.files)if(t.files[0]){this.isInProgress=!0,this.previewContext.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height);const e=t.files[0],i=new FileReader;i.onload=async()=>{try{const t=await R.Ay.load(i.result);this.img.src=t.toDataURL()}catch(t){this.isInProgress=!1,console.error(t),alert("Well that failed.\n\nMaybe this file isn't an image?")}},i.readAsDataURL(e)}else alert("Please select a file before clicking 'Load'.");else alert("The browser you are using sucks.\nTry using Firefox or Chrome instead.");else alert("Failed to find the image-file-chooser element... somehow.")},updateContrast(){this.isContrastComputed=!1,this.isInProgress=!0,setTimeout((()=>{const t=parseInt(document.getElementById("contrast-range").value),e=this.inputContext.getImageData(0,0,this.inputCanvas.width,this.inputCanvas.height),i=document.querySelector("[name='contrast-type']:checked").value;let s=t/100;"val"==i&&(s*=256);let n=0;for(let a=0;a<e.height;a++)for(let t=0;t<e.width;t++){let o;if("val"==i)o=Math.max(e.data[n++],e.data[n++],e.data[n++]);else{const t={red:e.data[n++],green:e.data[n++],blue:e.data[n++]},s=this.rgb2hsv(t);"sat"==i?o=s[1]:"hue"==i&&(o=s[0])}this.setPixel(this.outputContext,t,a,o<s?S:B),n++}this.copyToPreview(),this.isContrastComputed=!0,this.isInProgress=!1,setTimeout((()=>{document.querySelector("input[name='edge-detection-type']").checked=!1,this.edgeDetectionType&&(document.getElementById("edge-detection-type-"+this.edgeDetectionType).checked=!0),this.initHysteresisRange()}),0)}),40)},rgb2hsv(t){const e=t.red/255,i=t.green/255,s=t.blue/255,n=Math.min(e,i,s),a=Math.max(e,i,s),o=a;if(n==a)return[0,0,o];const u=e==n?i-s:s==n?e-i:s-e,r=e==n?3:s==n?1:5,h=(r-u/(a-n))/4,d=(a-n)/a;return[h,d,o]},getPixel(t,e,i){let s=4*(i*t.width+e);return{red:t.data[s++],green:t.data[s++],blue:t.data[s++]}},setPixel(t,e,i,s){t.fillStyle=s,t.fillRect(e,i,1,1)},isBlack(t){return!this.isWhite(t)},isWhite(t){return 255==t.red&&255==t.green&&255==t.blue},initHysteresisRange(){},repaint(){const t={width:this.previewCanvas.width,height:this.img.height*this.previewCanvas.width/this.img.width};this.previewContext.drawImage(this.img,0,0,t.width,t.height),this.inputCanvas.setAttribute("width",this.img.width),this.inputCanvas.setAttribute("height",this.img.height),this.outputCanvas.setAttribute("width",this.img.width),this.outputCanvas.setAttribute("height",this.img.height),this.inputContext.drawImage(this.img,0,0,this.img.width,this.img.height)},copyToPreview(){this.previewContext.drawImage(this.outputCanvas,0,0,this.outputCanvas.width,this.outputCanvas.height,0,0,this.previewCanvas.width,this.img.height*this.previewCanvas.width/this.img.width)}},computed:{},mounted(){function t(t){const e=parseInt(window.getComputedStyle(document.getElementById("controls")).width);t.setAttribute("width",innerWidth-e-60),t.setAttribute("height",innerHeight-40)}console.log("mounted"),this.img=document.getElementById("input-image"),this.edgeImg=document.getElementById("edge-image"),this.inputCanvas=document.getElementById("input-canvas"),this.previewCanvas=document.getElementById("preview-canvas"),this.outputCanvas=document.getElementById("output-canvas"),this.previewContext=this.previewCanvas.getContext("2d"),this.inputContext=this.inputCanvas.getContext("2d"),this.outputContext=this.outputCanvas.getContext("2d"),t(this.inputCanvas),t(this.previewCanvas),window.addEventListener("resize",(()=>{t(this.inputCanvas),t(this.previewCanvas)})),this.img.onload=()=>{this.repaint(),this.isImageLoaded=!0,this.isInProgress=!1},this.edgeImg.onload=()=>{this.outputContext.fillStyle=B,this.outputContext.fillRect(0,0,this.outputCanvas.width,this.outputCanvas.height),this.outputContext.drawImage(this.edgeImg,0,0,this.outputCanvas.width,this.outputCanvas.height);const t=this.outputContext.getImageData(0,0,this.outputCanvas.width,this.outputCanvas.height);for(let e=1;e<this.outputCanvas.width-1;e++)for(let i=1;i<this.outputCanvas.height-1;i++)this.isWhite(this.getPixel(t,e,i))?(this.setPixel(this.outputContext,e,i,S),this.edgePoints.push([e,i])):this.setPixel(this.previewContext,e,i,B);this.isEdgesComputed=!0,this.copyToPreview(),this.isInProgress=!1}}},F=i(1241);const O=(0,F.A)(A,[["render",E]]);var M=O;(0,s.Ef)(M).mount("#app")}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var a=e[s]={exports:{}};return t[s].call(a.exports,a,a.exports,i),a.exports}i.m=t,function(){var t=[];i.O=function(e,s,n,a){if(!s){var o=1/0;for(d=0;d<t.length;d++){s=t[d][0],n=t[d][1],a=t[d][2];for(var u=!0,r=0;r<s.length;r++)(!1&a||o>=a)&&Object.keys(i.O).every((function(t){return i.O[t](s[r])}))?s.splice(r--,1):(u=!1,a<o&&(o=a));if(u){t.splice(d--,1);var h=n();void 0!==h&&(e=h)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[s,n,a]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};i.O.j=function(e){return 0===t[e]};var e=function(e,s){var n,a,o=s[0],u=s[1],r=s[2],h=0;if(o.some((function(e){return 0!==t[e]}))){for(n in u)i.o(u,n)&&(i.m[n]=u[n]);if(r)var d=r(i)}for(e&&e(s);h<o.length;h++)a=o[h],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(d)},s=self["webpackChunkdoodler_vue"]=self["webpackChunkdoodler_vue"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=i.O(void 0,[504],(function(){return i(238)}));s=i.O(s)})();
//# sourceMappingURL=app.ff72ea8e.js.map